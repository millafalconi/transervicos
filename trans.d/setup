#!/usr/bin/env bash
# vim: ft=sh

#What do we need to check for:
##Vagrant installed? DONE
##Vagrant Cashier? DONE
##VirtalBox installed DONE
##Ansible installed? DONE

SUBCOMMAND_DESC="Verifique o setup do projeto"
SUBCOMMAND_HELP=$(cat <<EOH
Usage ${MAIN_COMMAND} ${SUBCOMMAND} [check] [install]

check Verifica se todas as dependências estão instaladas.
install TODO!

EOH
)

function check_if_plugin_installed() {
  if [[ $(${1} plugin list | grep "${2}") = *${2}* ]]; then
    in_green "OK: "${2}" instalado"
    return
  fi
  in_red "NOK: "${2}" é necessário. "${2}" não está instalado"
}

function check_if_installed() {
  if [ -x "$(command -v ${1})" ]; then
    in_green "OK: ${1} instalado"
    return
  fi
  in_red "NOK: ${1} é necessário. ${1} não está instalado"
}

function check_setup() {
  check_if_installed "ansible"
  check_if_installed "vagrant"
  check_if_plugin_installed "vagrant" "vagrant-cachier"
  check_if_installed "virtualbox"
}

function install_dependencies() {
  echo "install all was called"
}

is_help_mode "${@}" && return

#Different actions based on arguments
case ${1} in
  check)
    check_setup
    ;;
  install)
    install_dependencies
  ;;
esac
