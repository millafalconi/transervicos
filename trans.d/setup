#!/usr/bin/env bash
# vim: ft=sh

#What do we need to check for:
##Vagrant installed? DONE
##Vagrant Cashier?
##VirtalBox installed DONE
##Ansible installed? DONE

SUBCOMMAND_DESC="Verifique o setup do projeto"
SUBCOMMAND_HELP=$(cat <<EOH
Usage ${MAIN_COMMAND} ${SUBCOMMAND} [check] [install]

check TODO!
install TODO!

EOH
)

function check_vagrant_installed() {
  if [ -x "$(command -v vagrant)" ]; then
    in_green "[OK] Vagrant instalado"
    return
  fi
  in_red "[NOK] Vagrant é necessário. Vagrant não está instalado"
}

function check_vagrant_cachier_installed() {
  if [[ $(vagrant plugin list | grep 'vagrant-cachier') = *vagrant-cachier* ]]; then
    in_green "[OK] Vagrant Cachier instalado"
    return
  fi
  in_red "[NOK] Vagrant Cachier é necessário. Vagrant Cachier não está instalado"
}

function check_ansible_installed() {
  if [ -x "$(command -v ansible)" ]; then
    in_green "[OK] Ansible instalado"
    return
  fi
  in_red "[NOK] Ansible é necessário. Ansible não está instalado"
}

function check_virtualbox_installed() {
  if [ -x "$(command -v virtualbox)" ]; then
    in_green "[OK] VirtualBox instalado"
    return
  fi
  in_red "[NOK] VirtualBox é necessário. VirtualBox não está instalado"
}

function check_setup() {
  check_ansible_installed
  check_vagrant_installed
  check_vagrant_cachier_installed
  check_virtualbox_installed
}

function install_dependencies() {
  echo "install all was called"
}

is_help_mode "${@}" && return

#Different actions based on arguments
case ${1} in
  check)
    check_setup
    ;;
  install)
    install_dependencies
  ;;
esac
